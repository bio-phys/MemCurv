=====================================================
MEMBRANE SHAPE and CURVATURE
=====================================================

:Authors:       Ramachandra M. Bhaskara
:Year:          2019
:Licence:       GPLv3
:Copyright:      2019 Ramachandra M. Bhaskara, Gerhard Hummer
:References:    - [Bhaskara2019] Bhaskara RM, Grumati P, Garcia-Padro J, Kalayil S, Covurrbais-Pinto A, Chen W, Kudrashyev M, Dikic I, Hummer G. Curvature induction and sensing by FAM134B Reticulon homology domain assist selective-ER phagy.

Description
=============

This software contains a list of python scripts used to

1. Compute curvatures of discontinuous membrane systems
2. a. Fit shape profiles of membranes under PBC.
   b. Compute local curvatures of membranes under PBC.

For a detailed description of the procedure and the algorithm, we refer to [Bhaskara2019].

../image:: /img/curv.png 

Overview of the Curvature software
------------------------------------

The sofware contains two Python packages:

*`Fit_bicelle_sph_cap.py`_ provides algorithm for description of shape changes of a discontinuous membrane pathch. For.e.g. bicelle-to-vesicle conversion by patch-closure. The program uses least square fits for curved membrane-patches to spherical cup/cap shaped surfaces, to compute the constant mean curvature. 

*`Get_mem_profile_hcf_abcd.py` and `Cal_local_curv_props_abcd.py` are a combined package which provide algorithms for description of curved membrane surfaces under periodic boundary conditions. They can be used independently with a trajectory of curved membrane surface to quantify the membrane shapes and to compute local curvature properties. 

Help
====

Please, if you have an issue with the software, open an issue here on the github repository https://github.com/bio-phys/curvature/issues .

Dependendencies and Software Requirements
=========================================

* Python 2.7
* Python packages: numpy, scipy, MDAnalysis, pandas

Installation
============
No instalation required. Directly run the Python programs if the dependecies are installed before.

Usage
=====

(1)needs two files from discontinuous simulations.
fam_bicelle.gro:        a configuration file from MARTINI simulation
fam_bicelle.xtc:        a processed GROMACS trajectory of the membrane patch, e.g. bicelle system.

./python Fit_bicelle_sph_cap.py
The output file contains

(2) needs two files from the curved bilayer simulations under PBC conditions
fam_buckle.gro:         a configuration file of the curved bilayer from MARTINI simulation
fam_buckle_100ns.xtc:   a processed GROMACS trajectory of the buckled membrane simulation

./python Get_mem_profile_hcf_abcd.py
./python Cal_local_curv_props_abcd.py

Other options and settings
--------------------------
Depending on membrane composition, the selection of atom type constituting the mid-plane of the bilayer needs to be selected. 

In curvature computations, If protein coordinates isis provided, the local curvatue is computed at the center of mass of the protein atoms. 

Default settings
----------------

Output
------
Three output files are generated by default naming.

(1) Shapes of discontinuous membrane shapes
Fit_bicelle_sph_cap.py generates an output file "bicelle_curv_ts.dat" which contains 8 tab delimited columns
1. Trajectory frame/time
2. Radius of Fitted spherical surface [Angstroms]
3. Curvature of the fitted surface [1/Angstroms]
4-6. Co-ooddinate of the center of the fitted sphere [x_c, y_c, z_c]
7. Residual from the least square fit
8. iterations

(2a) Shapes of curved membrane profile under PBC.
Get_mem_profile_hcf_abcd.py generates an output file "popf_1ns_k3_abcd_fam_buckled.dat" which contains optimized height coefficients descibing the membrane shape profile. 
The first column contains the time/frame of the trajectory 
The 2nd-last columns contain different height coefficients. They can always be written as four kxk matrices.

(2b) Local curvarure sampled by protein/membrane inclusions in curved membranes.
Cal_local_curv_props_abcd.py generates an output file "fam_1ns_abcd_k3_curv_props.dat" which contains the local curvature properties of the sampled protein curvatures (tab delimited file).
1. Trajectory frame/time
2. Gaussian curvature K_G(x,y)
3. Mean curvature H(x,y)
4. Principal curvature k_1(x,y)
5. Principal curvature k_2(x,y)
6. Angle (deg) between local k_1(x,y) and e_x
7. Angle (deg) between local k_2(x,y) and e_x
8-13 same as 2-7, but computed for amphipathic helix 1 (AmpH1).
14-19 same as 2-7, but computed for amphipathic helix 2 (AmpH2).
20. Angle (deg) between AmpH1 and e_x
21. Angle (deg) between AmpH2 and e_x
22. Angle (deg) between AmpH1 and AmpH2
23. Angle (deg) between AmpH1 and k_1(x,y)
24. Angle (deg) between AmpH2 and k_1(x,y)
25-26 x, y coordinates defining the COM of protein. 

Misc information
----------------


FAQs
====
Q: My curvature values have negative instead of positive values. What is going on?

A: The sign of the curvature is dictated by convention. In the Monge representation, using h(x,y) representation of the membrane profile gives the curvature of the lower leaflet of the profile. To compute curvatues along upper leaflet, as in the manuscript (Shape operator S=-S).

Q: How is the sign of the bicelle curvature decided?

A: The bicelle curvatue sign depends on the lipid flip-flop at the open edge. If more than 50 % upper leaflet lipids from the starting structure flip onto the lower leaflet, the sign of the curvarature is -ve. 


